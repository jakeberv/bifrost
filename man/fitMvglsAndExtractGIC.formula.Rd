% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{fitMvglsAndExtractGIC.formula}
\alias{fitMvglsAndExtractGIC.formula}
\title{Fit mvgls Model Using a Formula and Extract GIC Score}
\usage{
fitMvglsAndExtractGIC.formula(formula, painted_tree, trait_data, ...)
}
\arguments{
\item{formula}{A character string specifying the model formula
(e.g., \code{"cbind(trait1, trait2) ~ predictor"}).}

\item{painted_tree}{An object of class \code{simmap} (see
\code{\link[phytools]{paintSubTree}}) used as the phylogenetic tree.}

\item{trait_data}{A \code{data.frame} or \code{matrix} of trait values with
row names that exactly match the tip labels of \code{painted_tree}.}

\item{...}{Additional arguments passed to \code{\link[mvMORPH]{mvgls}}.}
}
\value{
A \code{list} with two components:
\describe{
\item{\code{model}}{An object of class \code{mvgls}.}
\item{\code{GIC}}{A single numeric value with the Generalized Information Criterion.}
}
}
\description{
Fits a multivariate generalized least squares (mvgls) model to a
SIMMAP-formatted (painted) phylogenetic tree using a user-specified formula
and trait data. Automatically selects the evolutionary model:
\itemize{
\item \code{model = "BM"} when the painted tree has a single regime.
\item \code{model = "BMM"} when multiple regimes are present.
}
Returns the fitted model along with its Generalized Information Criterion (GIC) score.
}
\details{
The function converts the character \code{formula} to an actual formula
object via \code{\link[stats]{as.formula}} before fitting. The number of regimes
in \code{painted_tree} is detected with \code{\link[phytools]{getStates}}.
}
\examples{
\dontrun{
  set.seed(123)
  tree <- phytools::pbtree(n = 15, scale = 1)
  painted <- phytools::paintSubTree(tree, node = 16, state = "A", anc.state = "A")
  x <- rnorm(15)
  y1 <- 0.5 * x + rnorm(15)
  y2 <- -0.3 * x + rnorm(15)
  dat <- data.frame(x = x, y1 = y1, y2 = y2)
  rownames(dat) <- painted$tip.label
  result <- fitMvglsAndExtractGIC.formula("cbind(y1, y2) ~ x", painted, dat)
  result$GIC
}

}
\seealso{
\code{\link[mvMORPH]{mvgls}}, \code{\link[mvMORPH]{GIC}},
\code{\link[phytools]{getStates}}, \code{\link[stats]{as.formula}}
}
