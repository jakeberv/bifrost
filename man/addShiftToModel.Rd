% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{addShiftToModel}
\alias{addShiftToModel}
\title{Add a New Shift (Regime) to a SIMMAP Tree}
\usage{
addShiftToModel(tree, shift_node, current_shift_id)
}
\arguments{
\item{tree}{A \code{phylo} tree.}

\item{shift_node}{Integer node ID where the shift is added.}

\item{current_shift_id}{Integer identifier for the shift.}
}
\value{
A \code{list} with:
\describe{
\item{\code{tree}}{The updated SIMMAP tree with the new regime painted.}
\item{\code{shift_id}}{The incremented shift ID (integer).}
}
}
\description{
Increments a shift (regime) identifier and paints the subtree starting at
\code{shift_node} on a SIMMAP-style phylogenetic tree with the new state.
This enables stepwise construction of multi-regime models by applying
successive shifts with unique state IDs.
}
\details{
The subtree is painted using \code{paintSubTree_mod()} with
\code{overwrite = FALSE} and \code{stem = FALSE}, meaning only edges
matching the target state (typically the current state along that path)
are selectively overwritten, and the parent (incoming) edge to
\code{shift_node} is not split or repainted. If you need to force a full
overwrite or paint the stem, call \code{paintSubTree_mod()} directly.
}
\examples{
\dontrun{
  set.seed(1)
  tr <- phytools::pbtree(n = 12, scale = 1)

  # Initialize global mapping to state "0" (baseline)
  tr0 <- phytools::paintBranches(tr, edge = unique(tr$edge[,2]),
                                 state = "0", anc.state = "0")

  # Add first shift on an internal node
  nd <- ape::Ntip(tr0) + 2L
  res1 <- addShiftToModel(tr0, shift_node = nd, current_shift_id = 0L)
  res1$shift_id        # 1
  tr1 <- res1$tree     # SIMMAP with regime "1" painted on that clade

  # Add a second shift somewhere else
  nd2 <- ape::Ntip(tr1) + 3L
  res2 <- addShiftToModel(tr1, shift_node = nd2, current_shift_id = res1$shift_id)
  res2$shift_id        # 2
}
}
\seealso{
\code{\link{paintSubTree_mod}}, \code{\link[phytools]{paintSubTree}},
\code{\link[phytools]{paintBranches}}
}
