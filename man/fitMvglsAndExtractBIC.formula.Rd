% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{fitMvglsAndExtractBIC.formula}
\alias{fitMvglsAndExtractBIC.formula}
\title{Fit mvgls Model Using a Formula and Extract BIC Score}
\usage{
fitMvglsAndExtractBIC.formula(formula, painted_tree, trait_data, ...)
}
\arguments{
\item{formula}{A character string specifying the model formula
(e.g., \code{"cbind(trait1, trait2) ~ predictor"}).}

\item{painted_tree}{An object of class \code{simmap} (see
\code{\link[phytools]{paintSubTree}}) used as the phylogenetic tree.}

\item{trait_data}{A \code{data.frame} or \code{matrix} of trait values with
row names that exactly match the tip labels of \code{painted_tree}.}

\item{...}{Additional arguments passed to \code{\link[mvMORPH]{mvgls}}.}
}
\value{
A \code{list} with two components:
\describe{
\item{\code{model}}{An object of class \code{mvgls}.}
\item{\code{BIC}}{A single numeric value containing the Bayesian Information Criterion.}
}
}
\description{
Fits a multivariate generalized least squares (mvgls) model to a
SIMMAP-formatted (painted) phylogenetic tree using a user-specified formula
and trait data. Automatically selects the evolutionary model:
\itemize{
\item \code{model = "BM"} when the painted tree has a single regime.
\item \code{model = "BMM"} when multiple regimes are present.
}
Returns the fitted model along with its Bayesian Information Criterion (BIC) score.
}
\details{
The function converts the character \code{formula} to an actual formula
object via \code{\link[stats]{as.formula}} before fitting. The number of regimes
in \code{painted_tree} is detected with \code{\link[phytools]{getStates}}.
}
\examples{
\donttest{
  set.seed(321)
  tree <- phytools::pbtree(n = 12, scale = 1)
  painted <- phytools::paintSubTree(tree, node = 13, state = "A", anc.state = "A")
  x <- rnorm(12)
  y <- x + rnorm(12)
  dat <- data.frame(x = x, y = y)
  rownames(dat) <- painted$tip.label
  result <- fitMvglsAndExtractBIC.formula("y ~ x", painted, dat)
  result$BIC
}

}
\seealso{
\code{\link[mvMORPH]{mvgls}}, \code{\link[stats]{BIC}},
\code{\link[phytools]{getStates}}, \code{\link[stats]{as.formula}}
}
