% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{fitMvglsAndExtractBIC}
\alias{fitMvglsAndExtractBIC}
\title{Fit mvgls Model to a Painted Tree and Extract BIC Score}
\usage{
fitMvglsAndExtractBIC(painted_tree, trait_data)
}
\arguments{
\item{painted_tree}{An object of class \code{simmap} (see
\code{\link[phytools]{paintSubTree}}) used as the phylogenetic tree.
Must be fully dichotomous.}

\item{trait_data}{A numeric matrix of trait values (species Ã— traits).
Row names must exactly match the tip labels of \code{painted_tree} and
be in the same order.}
}
\value{
A \code{list} with two components:
\describe{
\item{\code{model}}{An object of class \code{mvgls}.}
\item{\code{BIC}}{A single numeric value, the Bayesian Information Criterion.}
}
}
\description{
Fits a multivariate generalized least squares (mvgls) model using a
SIMMAP-formatted (painted) phylogenetic tree and a matrix of trait data,
returning both the fitted model object and its Bayesian Information Criterion
(BIC) score.
}
\details{
This function always fits a multi-rates Brownian motion model
(\code{model = "BMM"}) under a simple intercept-only design
(\code{~ 1}). For trees with a single painted regime, the model is
equivalent to a standard Brownian motion fit.
}
\examples{
\dontrun{
  set.seed(1)
  tree <- phytools::pbtree(n = 10, scale = 1)
  tree_painted <- phytools::paintSubTree(tree, node = 11, state = "A", anc.state = "A")
  trait_mat <- matrix(rnorm(10 * 3), ncol = 3)
  rownames(trait_mat) <- tree_painted$tip.label
  result <- fitMvglsAndExtractBIC(tree_painted, trait_mat)
  result$BIC
}

}
\seealso{
\code{\link[mvMORPH]{mvgls}}, \code{\link[stats]{BIC}},
\code{\link[phytools]{paintSubTree}}
}
