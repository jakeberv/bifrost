% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{paintSubTree_mod}
\alias{paintSubTree_mod}
\title{Paint a Subtree in a Phylogenetic Tree with Optional Selective Overwriting}
\usage{
paintSubTree_mod(
  tree,
  node,
  state,
  anc.state = "1",
  stem = FALSE,
  overwrite = TRUE
)
}
\arguments{
\item{tree}{A \code{phylo} tree.}

\item{node}{Integer node to paint.}

\item{state}{Character regime label.}

\item{anc.state}{Character ancestral state label.}

\item{stem}{Logical, paint along the stem.}

\item{overwrite}{Logical, overwrite existing states.}
}
\value{
A modified tree of class \code{c("simmap", "phylo")} with updated
\code{$maps} and \code{$mapped.edge}.
}
\description{
Modifies a phylogenetic tree by painting the clade descending from a
specified node with a new discrete state and returns a SIMMAP-style tree.
You can either overwrite the entire subtree (\code{overwrite = TRUE}) or
selectively overwrite only edges currently in a \emph{target} state
(\code{overwrite = FALSE}). Optional stem painting splits the parent edge
into ancestral and derived states.
}
\details{
\itemize{
\item If \code{tree$maps} is \code{NULL}, the function initializes a SIMMAP
representation by assigning each edge length to \code{anc.state}.
\item With \code{overwrite = TRUE}, every edge in the subtree is collapsed
to a single segment labeled \code{state}.
\item With \code{overwrite = FALSE}, only edges matching the target state
(the state on the edge entering \code{node}, or \code{anc.state}
for tips) are replaced; other existing states are preserved.
\item If \code{stem} is numeric in \eqn{[0,1]}, the parent edge is split
into two segments: \code{(1 - stem)} of \code{anc.state} and
\code{stem} of \code{state}.
}
}
\examples{
\dontrun{
  set.seed(1)
  tr <- phytools::pbtree(n = 10, scale = 1)
  # Initialize mappings to "0" globally
  tr0 <- phytools::paintBranches(tr, edge = unique(tr$edge[,2]), state = "0", anc.state = "0")

  # Paint an internal clade fully as "1"
  nd <- ape::Ntip(tr0) + 2L
  tr1 <- paintSubTree_mod(tr0, node = nd, state = "1", anc.state = "0", stem = TRUE, overwrite = TRUE)

  # Selectively overwrite only edges already in state "0" within the subtree
  tr2 <- paintSubTree_mod(tr1, node = nd, state = "2", anc.state = "0", stem = 0.25, overwrite = FALSE)
}
}
\seealso{
\code{\link[phytools]{paintSubTree}}, \code{\link[phytools]{paintBranches}}
}
